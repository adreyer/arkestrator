{% extends "base.html" %}

{% block extrahead %}
<script type="text/javascript" language="JavaScript" src="{{ MEDIA_URL }}js/quote.js"></script>
<title>{{ thread.subject}} - {{ site_name }}</title>
{% endblock %}

{% block pagetitle %}
    <h1>{{ thread.subject }} </h1>
{% endblock %}

{% load bbcode %}
{% block extramenu %}
    <div id="submenu">
        <ul>
            {% if not expand %}
                <li class="submenuitem"><a href="{% url view-thread-full thread.id %}">Show all ({{ thread.total_posts }})</a></li>
            {% endif %}
            <li class="submenuitem"><a href="/this/does/nothing/lol">Hide images</a></li>
            <li class="submenuitem"><a href="{% url thread-history thread.id %}">Thread history</a></li>
            {% if perms.board.can_sticky %}
              {% if thread.stuck %}
                <li class="submenuitem"><a href="{% url unsticky thread.id %}">Unsticky thread</a></li>
              {% else %}
                <li class="submenuitem"><a href="{% url sticky thread.id %}">Sticky thread</a></li>
              {% endif %}
            {% endif %}
            {% if perms.board.can_lock %}
                {% if thread.locked %}
                <li class="submenuitem"><a href="{% url unlock-thread thread.id %}">Unlock thread</a></li>
                {% else %}
                <li class="submenuitem"><a href="{% url lock-thread thread.id %}">Lock thread</a></li>
                {% endif %}
             {% endif %}
            <li class="submenuitem floatright"><a href="#pagebottom">Jump to bottom</a></li>
        </ul>
    </div>
{% endblock %}
{% block content %}
    {% for post in object_list %}
        <div class="post">
            <a name="{{ post.id }}"></a>
            {% if post.creator == user %}
                <div class="my_post">
            {% else %}
                <div class="row2">
            {% endif %}
                <span id="info_{{ post.id}}"><strong><a href="{% url view-profile post.creator.id %}">{{ post.creator.username }}</a></strong> posted this on {{ post.created_at|date:"D, d-M-Y \a\t h:m:s a"}}</span>
                <strong><a href="javascript:;" onclick="quote('{% url get-quote post.id %}')">#{{ post.id }}</a></strong>
            </div>
            <div class="body" id="post_{{ post.id }}">
                <p>{% bbcode post.body %}</p>
            </div>
        </div>
    {% endfor %}
{% endblock %}
{% block bottombezel %}
    <div id="bottombezel">
        <ul>
            <li class="submenuitem"><a href="{% url list-threads %}">Go back</a></li>
            <li class="submenuitem floatright"><a href="#pagetop">Jump to top</a></li>
        </ul>
    </div>
{% endblock %}
{% block replyform %}
{% if not thread.locked %}
<a name="post"></a>
    <form method="post" action="{% url view-thread thread.id %}#post" onSubmit="document.getElementById('postbutton').style.display='none';">
    {% csrf_token %}
    <p class="replyform">
        {{ form.body.errors }}<br />{{ form.body }}<br />
        {{ form.form_lock }}
        <input class="button" type="submit" id="postbutton" value="Say it" />
        </p>
    </form>
{% else %}
    <div class="notice">This thread is locked. No more replies may be added.</div>
{% endif %}
{% endblock %}
